(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[641],{8306:(e,a,t)=>{Promise.resolve().then(t.bind(t,15726))},11647:(e,a,t)=>{"use strict";t.d(a,{E:()=>l});var i=t(95155);t(12115);var n=t(83101),s=t(64269);let r=(0,n.F)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground",success:"border-transparent bg-success text-success-foreground hover:bg-success/80",warning:"border-transparent bg-yellow-500 text-white hover:bg-yellow-500/80",info:"border-transparent bg-blue-500 text-white hover:bg-blue-500/80"}},defaultVariants:{variant:"default"}});function l(e){let{className:a,variant:t,...n}=e;return(0,i.jsx)("div",{className:(0,s.cn)(r({variant:t}),a),...n})}},15726:(e,a,t)=>{"use strict";t.r(a),t.d(a,{default:()=>Z});var i=t(95155),n=t(12115),s=t(14585),r=t(19708),l=t(15894),d=t(66942),o=t(22544),c=t(98734),m=t(89106),u=t(19056),x=t(47691),h=t(32078),j=t(33133),p=t(17206),v=t(61521),g=t(8773),f=t(86948),y=t(3998),b=t(92033),D=t(81310),N=t(58772),C=t(13630),z=t(22452),A=t(73180),w=t(748),T=t(51149),S=t(65142),M=t(31120),I=t(76444),E=t(51834),G=t(98053),P=t(41052),H=t(11186),k=t(87270),B=t(84668),L=t(82286),R=t(64269);let q=L.bL,V=L.l9,F=n.forwardRef((e,a)=>{let{className:t,align:n="center",sideOffset:s=4,...r}=e;return(0,i.jsx)(L.ZL,{children:(0,i.jsx)(L.UC,{ref:a,align:n,sideOffset:s,className:(0,R.cn)("z-50 w-72 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",t),...r})})});F.displayName=L.UC.displayName;var J=t(11647);let $=e=>{if(!e)return;let a=e instanceof r.Timestamp?e.toDate():e;return(0,m.GP)(a,"yyyy-MM-dd")},O=c.Ik({id:c.Yj().optional(),title:c.Yj().min(3,"Il titolo \xe8 obbligatorio."),startDate:c.Yj({required_error:"La data di inizio \xe8 obbligatoria."}),startTime:c.Yj().regex(/^([0-1]?[0-9]|2[0-3]):[0-5][0-9]$/,"Formato ora non valido (HH:mm)."),endDate:c.Yj({required_error:"La data di fine \xe8 obbligatoria."}),endTime:c.Yj().regex(/^([0-1]?[0-9]|2[0-3]):[0-5][0-9]$/,"Formato ora non valido (HH:mm)."),discipline:c.Yj().optional(),gymId:c.Yj().optional(),status:c.k5(["confermata","annullata","festivita"]).default("confermata"),notes:c.Yj().optional()}),Y=c.Ik({startDate:c.Yj({required_error:"La data di inizio \xe8 obbligatoria."}),endDate:c.Yj({required_error:"La data di fine \xe8 obbligatoria."}),gymId:c.Yj({required_error:"La palestra \xe8 obbligatoria."}),discipline:c.k5(["Karate","Aikido"],{required_error:"La disciplina \xe8 obbligatoria."})}).refine(e=>(0,u.H)(e.endDate)>=(0,u.H)(e.startDate),{message:"La data di fine non pu\xf2 essere precedente a quella di inizio.",path:["endDate"]});function _(e){let{lesson:a,gyms:t,onSave:n,onCancel:s}=e,r=(0,o.mN)({resolver:(0,d.u)(O),defaultValues:a||{title:"",startDate:(0,m.GP)(new Date,"yyyy-MM-dd"),endDate:(0,m.GP)(new Date,"yyyy-MM-dd"),startTime:"00:00",endTime:"00:00",status:"confermata",notes:""}});return(0,i.jsx)(P.lV,{...r,children:(0,i.jsxs)("form",{onSubmit:r.handleSubmit(e=>{n(e)}),className:"space-y-4",children:[(0,i.jsx)(P.zB,{control:r.control,name:"title",render:e=>{let{field:a}=e;return(0,i.jsxs)(P.eI,{children:[(0,i.jsx)(P.lR,{children:"Titolo"}),(0,i.jsx)(P.MJ,{children:(0,i.jsx)(S.p,{...a})}),(0,i.jsx)(P.C5,{})]})}}),(0,i.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,i.jsx)(P.zB,{control:r.control,name:"startDate",render:e=>{let{field:a}=e;return(0,i.jsxs)(P.eI,{children:[(0,i.jsx)(P.lR,{children:"Data Inizio"}),(0,i.jsx)(P.MJ,{children:(0,i.jsx)(S.p,{type:"date",...a})}),(0,i.jsx)(P.C5,{})]})}}),(0,i.jsx)(P.zB,{control:r.control,name:"startTime",render:e=>{let{field:a}=e;return(0,i.jsxs)(P.eI,{children:[(0,i.jsx)(P.lR,{children:"Ora Inizio"}),(0,i.jsx)(P.MJ,{children:(0,i.jsx)(S.p,{type:"time",...a})}),(0,i.jsx)(P.C5,{})]})}})]}),(0,i.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,i.jsx)(P.zB,{control:r.control,name:"endDate",render:e=>{let{field:a}=e;return(0,i.jsxs)(P.eI,{children:[(0,i.jsx)(P.lR,{children:"Data Fine"}),(0,i.jsx)(P.MJ,{children:(0,i.jsx)(S.p,{type:"date",...a})}),(0,i.jsx)(P.C5,{})]})}}),(0,i.jsx)(P.zB,{control:r.control,name:"endTime",render:e=>{let{field:a}=e;return(0,i.jsxs)(P.eI,{children:[(0,i.jsx)(P.lR,{children:"Ora Fine"}),(0,i.jsx)(P.MJ,{children:(0,i.jsx)(S.p,{type:"time",...a})}),(0,i.jsx)(P.C5,{})]})}})]}),(0,i.jsx)(P.zB,{control:r.control,name:"discipline",render:e=>{let{field:a}=e;return(0,i.jsxs)(P.eI,{children:[(0,i.jsx)(P.lR,{children:"Disciplina"}),(0,i.jsxs)(H.l6,{onValueChange:a.onChange,defaultValue:a.value,children:[(0,i.jsx)(P.MJ,{children:(0,i.jsx)(H.bq,{children:(0,i.jsx)(H.yv,{placeholder:"Seleziona disciplina..."})})}),(0,i.jsxs)(H.gC,{children:[(0,i.jsx)(H.eb,{value:"Karate",children:"Karate"}),(0,i.jsx)(H.eb,{value:"Aikido",children:"Aikido"})]})]}),(0,i.jsx)(P.C5,{})]})}}),(0,i.jsx)(P.zB,{control:r.control,name:"gymId",render:e=>{let{field:a}=e;return(0,i.jsxs)(P.eI,{children:[(0,i.jsx)(P.lR,{children:"Palestra"}),(0,i.jsxs)(H.l6,{onValueChange:a.onChange,defaultValue:a.value,children:[(0,i.jsx)(P.MJ,{children:(0,i.jsx)(H.bq,{children:(0,i.jsx)(H.yv,{placeholder:"Seleziona palestra..."})})}),(0,i.jsx)(H.gC,{children:t.map(e=>(0,i.jsxs)(H.eb,{value:e.id,children:[e.id," - ",e.name]},e.id))})]}),(0,i.jsx)(P.C5,{})]})}}),(0,i.jsx)(P.zB,{control:r.control,name:"status",render:e=>{let{field:a}=e;return(0,i.jsxs)(P.eI,{children:[(0,i.jsx)(P.lR,{children:"Stato Lezione"}),(0,i.jsxs)(H.l6,{onValueChange:a.onChange,defaultValue:a.value,children:[(0,i.jsx)(P.MJ,{children:(0,i.jsx)(H.bq,{children:(0,i.jsx)(H.yv,{})})}),(0,i.jsxs)(H.gC,{children:[(0,i.jsx)(H.eb,{value:"confermata",children:"Confermata"}),(0,i.jsx)(H.eb,{value:"annullata",children:"Annullata"}),(0,i.jsx)(H.eb,{value:"festivita",children:"Festivit\xe0"})]})]}),(0,i.jsx)(P.C5,{})]})}}),(0,i.jsx)(P.zB,{control:r.control,name:"notes",render:e=>{let{field:a}=e;return(0,i.jsxs)(P.eI,{children:[(0,i.jsx)(P.lR,{children:"Note / Avvisi"}),(0,i.jsx)(P.MJ,{children:(0,i.jsx)(M.T,{...a,placeholder:"Es. Portare protezioni, lezione annullata per maltempo..."})}),(0,i.jsx)(P.C5,{})]})}}),(0,i.jsxs)(E.Es,{children:[(0,i.jsx)(y.$,{type:"button",variant:"ghost",onClick:s,children:"Annulla"}),(0,i.jsx)(y.$,{type:"submit",children:"Salva Lezione"})]})]})})}function K(e){let{gyms:a,onGenerate:t,onOpenChange:n}=e,s=(0,o.mN)({resolver:(0,d.u)(Y),defaultValues:{startDate:$((0,x.o)(new Date)),endDate:$((0,h.f)((0,x.o)(new Date),7))}});return(0,i.jsx)(P.lV,{...s,children:(0,i.jsxs)("form",{onSubmit:s.handleSubmit(e=>{t(e),n(!1)}),className:"space-y-4",children:[(0,i.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,i.jsx)(P.zB,{control:s.control,name:"startDate",render:e=>{let{field:a}=e;return(0,i.jsxs)(P.eI,{children:[(0,i.jsx)(P.lR,{children:"Dal"}),(0,i.jsx)(P.MJ,{children:(0,i.jsx)(S.p,{type:"date",...a})}),(0,i.jsx)(P.C5,{})]})}}),(0,i.jsx)(P.zB,{control:s.control,name:"endDate",render:e=>{let{field:a}=e;return(0,i.jsxs)(P.eI,{children:[(0,i.jsx)(P.lR,{children:"Al"}),(0,i.jsx)(P.MJ,{children:(0,i.jsx)(S.p,{type:"date",...a})}),(0,i.jsx)(P.C5,{})]})}})]}),(0,i.jsx)(P.zB,{control:s.control,name:"gymId",render:e=>{let{field:t}=e;return(0,i.jsxs)(P.eI,{children:[(0,i.jsx)(P.lR,{children:"Palestra"}),(0,i.jsxs)(H.l6,{onValueChange:t.onChange,defaultValue:t.value,children:[(0,i.jsx)(P.MJ,{children:(0,i.jsx)(H.bq,{children:(0,i.jsx)(H.yv,{placeholder:"Seleziona una palestra..."})})}),(0,i.jsx)(H.gC,{children:a.map(e=>(0,i.jsxs)(H.eb,{value:e.id,children:[e.id," - ",e.name]},e.id))})]}),(0,i.jsx)(P.C5,{})]})}}),(0,i.jsx)(P.zB,{control:s.control,name:"discipline",render:e=>{let{field:a}=e;return(0,i.jsxs)(P.eI,{children:[(0,i.jsx)(P.lR,{children:"Disciplina"}),(0,i.jsxs)(H.l6,{onValueChange:a.onChange,defaultValue:a.value,children:[(0,i.jsx)(P.MJ,{children:(0,i.jsx)(H.bq,{children:(0,i.jsx)(H.yv,{placeholder:"Seleziona una disciplina..."})})}),(0,i.jsxs)(H.gC,{children:[(0,i.jsx)(H.eb,{value:"Karate",children:"Karate"}),(0,i.jsx)(H.eb,{value:"Aikido",children:"Aikido"})]})]}),(0,i.jsx)(P.C5,{})]})}}),(0,i.jsxs)(E.Es,{children:[(0,i.jsx)(E.HM,{asChild:!0,children:(0,i.jsx)(y.$,{type:"button",variant:"ghost",children:"Annulla"})}),(0,i.jsx)(y.$,{type:"submit",children:"Genera Anteprima Test"})]})]})})}function Z(){let{toast:e}=(0,l.dj)(),[a,t]=(0,n.useState)(!0),[d,o]=(0,n.useState)(!1),[c,h]=(0,n.useState)(!1),[S,M]=(0,n.useState)(null),[P,L]=(0,n.useState)([]),[$,O]=(0,n.useState)([]),[Y,Z]=(0,n.useState)([]),[W,U]=(0,n.useState)(null),[Q,X]=(0,n.useState)([]),[ee,ea]=(0,n.useState)(""),[et,ei]=(0,n.useState)([]),[en,es]=(0,n.useState)(""),[er,el]=(0,n.useState)("Karate"),[ed,eo]=(0,n.useState)(!1),[ec,em]=(0,n.useState)(void 0),[eu,ex]=(0,n.useState)(!1),eh=async()=>{t(!0);try{let e=(await (0,r.getDocs)((0,r.query)((0,r.collection)(s.db,"gyms"),(0,r.orderBy)("name")))).docs.map(e=>({id:e.id,...e.data(),address:e.data().address||""}));L(e);let a=(await (0,r.getDocs)((0,r.query)((0,r.collection)(s.db,"dateGroups")))).docs.map(e=>{let a=e.data(),t=Array.isArray(a.dates)?a.dates:[];return{id:e.id,name:a.name,dates:t.map(e=>e instanceof r.Timestamp?e:new r.Timestamp(e.seconds,e.nanoseconds))}});ei(a);let t=await (0,r.getDoc)((0,r.doc)(s.db,"settings","activity")),i=await (0,r.getDoc)((0,r.doc)(s.db,"settings","season")),n=[];if(t.exists()){let e=t.data();n.push({id:"activity",label:"Stagione Allenamenti",startDate:e.startDate.toDate(),endDate:e.endDate.toDate()})}if(i.exists()){let e=i.data();n.push({id:"season",label:e.label||"Stagione Sportiva",startDate:e.startDate.toDate(),endDate:e.endDate.toDate()})}let l=new Date;n.push({id:"solar",label:"Anno Solare ".concat((0,j.C)(l)),startDate:(0,p.D)(l),endDate:(0,v.Q)(l)}),X(n),await ej()}catch(a){console.error(a),e({variant:"destructive",title:"Errore",description:"Impossibile caricare dati."})}finally{t(!1)}},ej=async()=>{try{let e=(await (0,r.getDocs)((0,r.query)((0,r.collection)(s.db,"calendars"),(0,r.orderBy)("createdAt","desc")))).docs.map(e=>{let a=e.data();return{id:e.id,...a}});O(e)}catch(a){console.error("Error fetching saved calendars:",a),e({variant:"destructive",title:"Errore",description:"Impossibile caricare i calendari salvati."})}finally{h(!1)}};(0,n.useEffect)(()=>{eh()},[]);let ep=Q.find(e=>e.id===ee),ev=async()=>{if(!ep||!en||!er)return void e({variant:"destructive",title:"Dati Mancanti",description:"Seleziona periodo, palestra e disciplina."});o(!0),Z([]);try{let{startDate:a,endDate:t}=ep,i=P.find(e=>e.id===en);if(!i){e({variant:"destructive",title:"Palestra non trovata",description:"La palestra selezionata non \xe8 valida."}),o(!1);return}let n=new Set,s=et.find(e=>e.id===i.id);s&&s.dates.forEach(e=>{n.add((0,m.GP)(e.toDate(),"yyyy-MM-dd"))});let l=(0,g.k)({start:(0,x.o)(a),end:(0,x.o)(t)}),d=[];l.forEach(e=>{var a;let t=(0,m.GP)(e,"yyyy-MM-dd"),s=n.has(t),l=(0,m.GP)(e,"EEEE",{locale:B.it}).charAt(0).toUpperCase()+(0,m.GP)(e,"EEEE",{locale:B.it}).slice(1),o=null==(a=i.weeklySchedule)?void 0:a.find(e=>e.dayOfWeek===l);(null==o?void 0:o.slots)&&o.slots.forEach((a,n)=>{if(a.discipline===er){var l;let[o,c]=a.startTime.split(":").map(Number),[m,u]=a.endTime.split(":").map(Number),x=new Date(e);x.setHours(o,c,0,0);let h=new Date(e);h.setHours(m,u,0,0),d.push({id:"".concat(t,"-").concat(n),title:s?"Chiuso per festivit\xe0":er,startTime:r.Timestamp.fromDate(x),endTime:r.Timestamp.fromDate(h),gymId:i.id,gymName:"".concat(i.id," - ").concat(i.name),discipline:er,status:s?"festivita":"confermata",notes:s?(null==(l=et.find(e=>e.id===i.id))?void 0:l.name)||"Festivit\xe0":""})}})});let c=d.filter(e=>"confermata"===e.status).length;Z(d);let u="".concat(i.id," - ").concat(i.name);U("Anteprima Calendario Standard per ".concat(u," - ").concat(er," (").concat(c," lezioni)")),e({title:"Anteprima Generata",description:"Trovate ".concat(c," lezioni per i criteri selezionati.")})}catch(a){console.error("Error generating preview:",a),e({variant:"destructive",title:"Errore",description:"Si \xe8 verificato un errore durante la generazione dell'anteprima."})}finally{o(!1)}},eg=async a=>{o(!0),Z([]);try{let{startDate:t,endDate:i,gymId:n,discipline:s}=a,l=P.find(e=>e.id===n);if(!l){e({variant:"destructive",title:"Palestra non trovata"}),o(!1);return}let d=(0,g.k)({start:(0,x.o)((0,u.H)(t)),end:(0,x.o)((0,u.H)(i))}),c=[];d.forEach(e=>{let a=(0,m.GP)(e,"yyyy-MM-dd"),t=new Date(e);t.setHours(18,0,0,0);let i=new Date(e);i.setHours(19,0,0,0),c.push({id:"".concat(a,"-TEST"),title:"".concat(s," (Test)"),startTime:r.Timestamp.fromDate(t),endTime:r.Timestamp.fromDate(i),gymId:l.id,gymName:"".concat(l.id," - ").concat(l.name),discipline:s,status:"confermata",notes:"Lezione di test generata automaticamente"})}),Z(c);let h="".concat(l.id," - ").concat(l.name);U("Anteprima Calendario di Test per ".concat(h," - ").concat(s," (").concat(c.length," lezioni)")),e({title:"Anteprima Test Generata",description:"Create ".concat(c.length," lezioni giornaliere.")})}catch(a){console.error("Error generating test preview:",a),e({variant:"destructive",title:"Errore",description:"Impossibile generare l'anteprima di test."})}finally{o(!1)}},ef=async()=>{let a,t,i;if(0===Y.length||!W)return void e({variant:"destructive",title:"Dati insufficienti",description:"Non ci sono lezioni nell'anteprima o mancano i filtri per salvare."});if(W.includes("di Test")?(a=Y[0].gymId,t=Y[0].discipline,i="Test dal ".concat((0,m.GP)(Y[0].startTime.toDate(),"dd/MM/yy")," al ").concat((0,m.GP)(Y[Y.length-1].startTime.toDate(),"dd/MM/yy"))):(a=en,t=er,i=null==ep?void 0:ep.label),!a||!t||!i)return void e({variant:"destructive",title:"Dati insufficienti",description:"Impossibile determinare palestra, disciplina o periodo."});h(!0);try{let n=P.find(e=>e.id===a);if(!n){e({variant:"destructive",title:"Palestra non trovata",description:"La palestra selezionata non \xe8 valida."}),h(!1);return}let l="".concat(n.id," - ").concat(n.name),d={gymId:n.id,gymName:l,year:(0,j.C)(Y[0].startTime.toDate()),discipline:t,calendarName:"Calendario per ".concat(l," - ").concat(t," (").concat(i,")"),createdAt:(0,r.serverTimestamp)()},o=await (0,r.addDoc)((0,r.collection)(s.db,"calendars"),d),c=(0,r.writeBatch)(s.db),m=(0,r.collection)(s.db,"events");Y.forEach(e=>{let{id:a,...t}=e,i=(0,r.doc)(m);c.set(i,{...t,type:"lesson",calendarId:o.id,createdAt:(0,r.serverTimestamp)()})}),await c.commit(),await ej();let u=Y.filter(e=>"confermata"===e.status).length;e({title:"Calendario Salvato!",description:"Un nuovo calendario con ".concat(u," lezioni operative \xe8 stato salvato con successo."),variant:"default"}),Z([]),U(null)}catch(a){console.error("Error saving calendar to Firebase:",a),e({variant:"destructive",title:"Errore di Salvataggio",description:"Impossibile salvare il calendario. Riprova."})}finally{h(!1)}},ey=async a=>{Z(e=>e.filter(e=>e.id!==a)),e({title:"Lezione Rimossa dall'Anteprima",description:"La lezione \xe8 stata eliminata solo dalla visualizzazione corrente. Per salvare le modifiche, clicca su 'Salva su DB'."})},eb=async a=>{let{startDate:t,startTime:i,endDate:n,endTime:s,...l}=a,d=(0,u.H)("".concat(t,"T").concat(i)),o=(0,u.H)("".concat(n,"T").concat(s)),c=P.find(e=>e.id===l.gymId),m={id:a.id||"manual-".concat(new Date().getTime()),title:l.title,startTime:r.Timestamp.fromDate(d),endTime:r.Timestamp.fromDate(o),discipline:l.discipline,gymId:l.gymId,gymName:c?"".concat(c.id," - ").concat(c.name):void 0,status:l.status,notes:l.notes};if(a.id&&!a.id.startsWith("manual-"))Z(e=>e.map(e=>e.id===a.id?m:e));else{let e=Y.findIndex(e=>e.id===m.id);e>-1?Z(a=>{let t=[...a];return t[e]=m,t}):Z(e=>[...e,m].sort((e,a)=>e.startTime.toMillis()-a.startTime.toMillis()))}e({title:"Lezione Aggiornata nell'Anteprima",description:"Salva il calendario per rendere la modifica permanente."}),eo(!1),em(void 0)},eD=async a=>{try{let t=(0,r.query)((0,r.collection)(s.db,"events"),(0,r.where)("calendarId","==",a.id),(0,r.orderBy)("startTime","asc")),i=(await (0,r.getDocs)(t)).docs.map(e=>({id:e.id,...e.data()}));Z(i);let n=i.filter(e=>"confermata"===e.status).length;U("Calendario Caricato: ".concat(a.calendarName," (").concat(n," lezioni)")),e({title:"Calendario Caricato",description:"Hai caricato ".concat(i.length," lezioni totali nell'area di anteprima.")})}catch(a){console.error("Error loading lessons for calendar:",a),e({variant:"destructive",title:"Errore",description:"Impossibile caricare le lezioni del calendario."})}},eN=async a=>{M(a);try{let t=(0,r.writeBatch)(s.db),i=(0,r.query)((0,r.collection)(s.db,"events"),(0,r.where)("calendarId","==",a));(await (0,r.getDocs)(i)).forEach(e=>{t.delete(e.ref)});let n=(0,r.doc)(s.db,"calendars",a);t.delete(n),await t.commit(),await ej(),e({title:"Calendario Eliminato",description:"Il calendario e tutte le sue lezioni associate sono stati rimossi con successo.",variant:"default"})}catch(a){console.error("Error deleting calendar and its events:",a),e({variant:"destructive",title:"Errore",description:"Impossibile eliminare il calendario e le sue lezioni. Se il problema persiste, crea un indice su 'calendarId' in Firestore (verr\xe0 generato un link nella console del browser se necessario)."})}finally{M(null)}},eC=Y.reduce((e,a)=>{let t=(0,m.GP)(a.startTime.toDate(),"MMMM yyyy",{locale:B.it});return e[t]||(e[t]=[]),e[t].push(a),e},{});return(0,i.jsxs)("div",{className:"space-y-8",children:[(0,i.jsxs)(f.Zp,{children:[(0,i.jsxs)(f.aR,{children:[(0,i.jsx)(f.ZB,{children:"Generatore Calendario Allenamenti"}),(0,i.jsx)(f.BT,{children:"Crea in massa le lezioni di routine per un periodo, includendo le festivit\xe0."})]}),(0,i.jsxs)(f.Wu,{className:"space-y-6",children:[(0,i.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,i.jsxs)("div",{className:"space-y-2",children:[(0,i.jsx)(I.J,{children:"Periodo Calendario"}),(0,i.jsxs)(H.l6,{value:ee,onValueChange:ea,children:[(0,i.jsx)(H.bq,{children:(0,i.jsx)(H.yv,{placeholder:"Seleziona un periodo..."})}),(0,i.jsx)(H.gC,{children:Q.map(e=>(0,i.jsxs)(H.eb,{value:e.id,children:[e.label," (",(0,m.GP)(e.startDate,"dd/MM/yy")," - ",(0,m.GP)(e.endDate,"dd/MM/yy"),")"]},e.id))})]})]}),(0,i.jsxs)("div",{className:"space-y-2",children:[(0,i.jsx)(I.J,{children:"Filtra per Disciplina"}),(0,i.jsxs)(H.l6,{value:er,onValueChange:el,children:[(0,i.jsx)(H.bq,{children:(0,i.jsx)(H.yv,{})}),(0,i.jsxs)(H.gC,{children:[(0,i.jsx)(H.eb,{value:"Karate",children:"Karate"}),(0,i.jsx)(H.eb,{value:"Aikido",children:"Aikido"})]})]})]})]}),(0,i.jsx)("div",{className:"grid grid-cols-1",children:(0,i.jsxs)("div",{className:"space-y-2",children:[(0,i.jsx)(I.J,{children:"Filtra per Palestra"}),(0,i.jsxs)(H.l6,{value:en,onValueChange:es,children:[(0,i.jsx)(H.bq,{children:(0,i.jsx)(H.yv,{placeholder:"Seleziona una palestra..."})}),(0,i.jsx)(H.gC,{children:P.map(e=>(0,i.jsxs)(H.eb,{value:e.id,children:[e.id," - ",e.name]},e.id))})]})]})})]}),(0,i.jsxs)(f.wL,{className:"flex gap-2",children:[(0,i.jsxs)(y.$,{onClick:()=>ev(),disabled:d||c,children:[d?(0,i.jsx)(b.A,{className:"animate-spin mr-2"}):null,"Genera Anteprima"]}),(0,i.jsxs)(E.lG,{open:eu,onOpenChange:ex,children:[(0,i.jsx)(E.zM,{asChild:!0,children:(0,i.jsxs)(y.$,{variant:"secondary",children:[(0,i.jsx)(D.A,{className:"mr-2"}),"Genera Calendario di Test"]})}),(0,i.jsxs)(E.Cf,{children:[(0,i.jsxs)(E.c7,{children:[(0,i.jsx)(E.L3,{children:"Crea Calendario di Test"}),(0,i.jsx)(E.rr,{children:"Seleziona un intervallo di date, una palestra e una disciplina. Verr\xe0 creata una lezione al giorno (18:00-19:00)."})]}),(0,i.jsx)(K,{gyms:P,onGenerate:eg,onOpenChange:ex})]})]})]})]}),(0,i.jsxs)(f.Zp,{children:[(0,i.jsxs)(f.aR,{children:[(0,i.jsx)(f.ZB,{children:"Gestione Calendari Salvati"}),(0,i.jsx)(f.BT,{children:"Carica, modifica o elimina i calendari che hai gi\xe0 creato e salvato su Firebase."})]}),(0,i.jsx)(f.Wu,{children:(0,i.jsxs)(k.XI,{children:[(0,i.jsx)(k.A0,{children:(0,i.jsxs)(k.Hj,{children:[(0,i.jsx)(k.nd,{children:"Nome Calendario"}),(0,i.jsx)(k.nd,{children:"Disciplina"}),(0,i.jsx)(k.nd,{children:"Palestra"}),(0,i.jsx)(k.nd,{children:"Creato il"}),(0,i.jsx)(k.nd,{className:"text-right",children:"Azioni"})]})}),(0,i.jsx)(k.BF,{children:a?(0,i.jsx)(k.Hj,{children:(0,i.jsx)(k.nA,{colSpan:5,className:"text-center h-24",children:(0,i.jsx)(b.A,{className:"mx-auto h-6 w-6 animate-spin"})})}):$.length>0?$.map(e=>(0,i.jsxs)(k.Hj,{children:[(0,i.jsx)(k.nA,{className:"font-medium",children:e.calendarName}),(0,i.jsx)(k.nA,{children:e.discipline}),(0,i.jsx)(k.nA,{children:e.gymName}),(0,i.jsx)(k.nA,{children:e.createdAt?(0,m.GP)(e.createdAt.toDate(),"dd/MM/yy HH:mm"):"N/D"}),(0,i.jsxs)(k.nA,{className:"text-right space-x-2",children:[(0,i.jsxs)(y.$,{variant:"outline",size:"sm",onClick:()=>eD(e),disabled:S===e.id,children:[(0,i.jsx)(N.A,{className:"h-4 w-4 mr-2"}),"Carica"]}),(0,i.jsxs)(G.Lt,{children:[(0,i.jsx)(G.tv,{asChild:!0,children:(0,i.jsx)(y.$,{variant:"destructive",size:"sm",disabled:S===e.id,children:S===e.id?(0,i.jsx)(b.A,{className:"h-4 w-4 animate-spin"}):(0,i.jsx)(C.A,{className:"h-4 w-4"})})}),(0,i.jsxs)(G.EO,{children:[(0,i.jsxs)(G.wd,{children:[(0,i.jsx)(G.r7,{children:"Sei assolutamente sicuro?"}),(0,i.jsxs)(G.$v,{children:["Questa azione non pu\xf2 essere annullata. Questo eliminer\xe0 permanentemente il calendario",(0,i.jsx)("strong",{className:"mx-1",children:e.calendarName}),"e tutte le lezioni associate dal database."]})]}),(0,i.jsxs)(G.ck,{children:[(0,i.jsx)(G.Zr,{children:"Annulla"}),(0,i.jsx)(G.Rx,{onClick:()=>eN(e.id),children:"S\xec, elimina"})]})]})]})]})]},e.id)):(0,i.jsx)(k.Hj,{children:(0,i.jsx)(k.nA,{colSpan:5,className:"text-center h-24",children:"Nessun calendario salvato trovato."})})})]})})]}),(0,i.jsxs)(f.Zp,{children:[(0,i.jsx)(f.aR,{children:(0,i.jsxs)("div",{className:"flex justify-between items-start sm:items-center flex-col sm:flex-row gap-4",children:[(0,i.jsxs)("div",{className:"flex-1",children:[(0,i.jsx)(f.ZB,{children:"Anteprima Calendario"}),W?(0,i.jsx)(f.BT,{className:"mt-2",children:W}):(0,i.jsx)(f.BT,{className:"mt-2",children:"Genera o carica un calendario per visualizzare le lezioni. Potrai modificarle o salvarle su Firebase."})]}),(0,i.jsxs)("div",{className:"flex w-full sm:w-auto gap-2",children:[(0,i.jsxs)(y.$,{onClick:()=>{em(void 0),eo(!0)},variant:"outline",className:"w-full sm:w-auto",children:[(0,i.jsx)(z.A,{className:"mr-2"}),"Aggiungi Lezione"]}),(0,i.jsxs)(y.$,{onClick:ef,disabled:c||d||0===Y.length,className:"w-full sm:w-auto",children:[c?(0,i.jsx)(b.A,{className:"animate-spin mr-2"}):(0,i.jsx)(A.A,{className:"mr-2"}),"Salva su DB"]})]})]})}),(0,i.jsx)(f.Wu,{children:a?(0,i.jsx)("div",{className:"flex justify-center h-32 items-center",children:(0,i.jsx)(b.A,{className:"w-8 h-8 animate-spin"})}):(0,i.jsxs)(k.XI,{children:[(0,i.jsx)(k.A0,{children:(0,i.jsxs)(k.Hj,{children:[(0,i.jsx)(k.nd,{children:"Stato"}),(0,i.jsx)(k.nd,{children:"Data"}),(0,i.jsx)(k.nd,{children:"Giorno"}),(0,i.jsx)(k.nd,{children:"Orario"}),(0,i.jsx)(k.nd,{children:"Titolo Lezione"}),(0,i.jsx)(k.nd,{children:"Luogo/Palestra"}),(0,i.jsx)(k.nd,{className:"text-right",children:"Azioni"})]})}),(0,i.jsx)(k.BF,{children:Object.entries(eC).length>0?Object.entries(eC).map(e=>{let[a,t]=e;return(0,i.jsxs)(n.Fragment,{children:[(0,i.jsx)(k.Hj,{className:"bg-muted/50 hover:bg-muted/50",children:(0,i.jsx)(k.nA,{colSpan:7,className:"font-bold text-lg capitalize text-primary py-3",children:a})}),t.map(e=>(0,i.jsxs)(k.Hj,{className:(0,R.cn)("annullata"===e.status&&"bg-destructive/10 text-muted-foreground","festivita"===e.status&&"bg-blue-500/10 text-blue-800"),children:[(0,i.jsx)(k.nA,{children:(0,i.jsxs)("div",{className:"flex items-center gap-2",children:[(0,i.jsx)(J.E,{variant:"annullata"===e.status?"destructive":"festivita"===e.status?"info":"success",children:"annullata"===e.status?"Annullata":"festivita"===e.status?"Festivit\xe0":"OK"}),e.notes&&(0,i.jsxs)(q,{children:[(0,i.jsx)(V,{asChild:!0,children:(0,i.jsx)(y.$,{variant:"ghost",size:"icon",className:"h-6 w-6",children:"festivita"===e.status?(0,i.jsx)(w.A,{className:"h-4 w-4 text-blue-500"}):(0,i.jsx)(T.A,{className:"h-4 w-4 text-amber-500"})})}),(0,i.jsxs)(F,{className:"text-sm w-80",children:[(0,i.jsx)("p",{className:"font-bold mb-2",children:"Note lezione:"}),e.notes]})]})]})}),(0,i.jsx)(k.nA,{children:(0,m.GP)(e.startTime.toDate(),"dd/MM/yy",{locale:B.it})}),(0,i.jsx)(k.nA,{className:"capitalize",children:(0,m.GP)(e.startTime.toDate(),"eeee",{locale:B.it})}),(0,i.jsx)(k.nA,{children:"".concat((0,m.GP)(e.startTime.toDate(),"HH:mm")," - ").concat((0,m.GP)(e.endTime.toDate(),"HH:mm"))}),(0,i.jsx)(k.nA,{className:"font-medium capitalize",children:e.title}),(0,i.jsx)(k.nA,{children:e.gymName}),(0,i.jsxs)(k.nA,{className:"text-right",children:[(0,i.jsx)(y.$,{variant:"ghost",size:"sm",onClick:()=>(e=>{let a=e.startTime.toDate(),t=e.endTime.toDate();em({id:e.id,title:e.title,startDate:(0,m.GP)(a,"yyyy-MM-dd"),startTime:(0,m.GP)(a,"HH:mm"),endDate:(0,m.GP)(t,"yyyy-MM-dd"),endTime:(0,m.GP)(t,"HH:mm"),discipline:e.discipline,gymId:e.gymId,status:e.status,notes:e.notes}),eo(!0)})(e),children:"Modifica"}),(0,i.jsx)(y.$,{variant:"ghost",size:"sm",className:"text-destructive hover:text-destructive",onClick:()=>ey(e.id),children:(0,i.jsx)(C.A,{className:"w-4 h-4"})})]})]},e.id))]},a)}):(0,i.jsx)(k.Hj,{children:(0,i.jsx)(k.nA,{colSpan:7,className:"text-center h-24 text-muted-foreground",children:"Nessuna lezione da mostrare. Genera un'anteprima o aggiungine una manualmente."})})})]})})]}),(0,i.jsx)(E.lG,{open:ed,onOpenChange:e=>{eo(e),e||em(void 0)},children:(0,i.jsxs)(E.Cf,{className:"sm:max-w-2xl",children:[(0,i.jsx)(E.c7,{children:(0,i.jsx)(E.L3,{children:ec?"Modifica Lezione":"Crea Nuova Lezione"})}),(0,i.jsx)(_,{lesson:ec,gyms:P,onSave:eb,onCancel:()=>eo(!1)})]})})]})}},31120:(e,a,t)=>{"use strict";t.d(a,{T:()=>r});var i=t(95155),n=t(12115),s=t(64269);let r=n.forwardRef((e,a)=>{let{className:t,...n}=e;return(0,i.jsx)("textarea",{className:(0,s.cn)("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",t),ref:a,...n})});r.displayName="Textarea"}},e=>{e.O(0,[2992,7138,4909,3947,7134,9106,1930,2445,531,1821,3064,2885,2882,9988,6980,8441,1255,7358],()=>e(e.s=8306)),_N_E=e.O()}]);