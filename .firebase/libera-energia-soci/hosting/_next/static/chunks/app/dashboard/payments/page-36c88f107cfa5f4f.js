(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[889],{11647:(e,t,r)=>{"use strict";r.d(t,{E:()=>i});var a=r(95155);r(12115);var s=r(83101),n=r(64269);let o=(0,s.F)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground",success:"border-transparent bg-success text-success-foreground hover:bg-success/80",warning:"border-transparent bg-yellow-500 text-white hover:bg-yellow-500/80",info:"border-transparent bg-blue-500 text-white hover:bg-blue-500/80"}},defaultVariants:{variant:"default"}});function i(e){let{className:t,variant:r,...s}=e;return(0,a.jsx)("div",{className:(0,n.cn)(o({variant:r}),t),...s})}},14585:(e,t,r)=>{"use strict";r.d(t,{IG:()=>c,db:()=>l,j2:()=>d});var a=r(52078),s=r(19708),n=r(58134),o=r(59253);let i=(0,a.Dk)().length?(0,a.Sx)():(0,a.Wp)({apiKey:"AIzaSyAeNVPO7H0mlsM3FXjjZJqpeB5Fi6ITISw",authDomain:"libera-energia-soci.firebaseapp.com",projectId:"libera-energia-soci",storageBucket:"libera-energia-soci.firebasestorage.app",messagingSenderId:"371255545862",appId:"1:371255545862:web:295479b2e6d2dadebaf387",measurementId:"G-4NWSYM1KPW"}),d=(0,o.xI)(i),l=(0,s.getFirestore)(i),c=(0,n.c7)(i)},15894:(e,t,r)=>{"use strict";r.d(t,{dj:()=>u});var a=r(12115);let s=0,n=new Map,o=e=>{if(n.has(e))return;let t=setTimeout(()=>{n.delete(e),l({type:"REMOVE_TOAST",toastId:e})},1e6);n.set(e,t)},i=[],d={toasts:[]};function l(e){d=((e,t)=>{switch(t.type){case"ADD_TOAST":return{...e,toasts:[t.toast,...e.toasts].slice(0,5)};case"UPDATE_TOAST":return{...e,toasts:e.toasts.map(e=>e.id===t.toast.id?{...e,...t.toast}:e)};case"DISMISS_TOAST":{let{toastId:r}=t;return r?o(r):e.toasts.forEach(e=>{o(e.id)}),{...e,toasts:e.toasts.map(e=>e.id===r||void 0===r?{...e,open:!1}:e)}}case"REMOVE_TOAST":if(void 0===t.toastId)return{...e,toasts:[]};return{...e,toasts:e.toasts.filter(e=>e.id!==t.toastId)}}})(d,e),i.forEach(e=>{e(d)})}function c(e){let{...t}=e,r=(s=(s+1)%Number.MAX_SAFE_INTEGER).toString(),a=()=>l({type:"DISMISS_TOAST",toastId:r});return l({type:"ADD_TOAST",toast:{...t,id:r,open:!0,onOpenChange:e=>{e||a()}}}),{id:r,dismiss:a,update:e=>l({type:"UPDATE_TOAST",toast:{...e,id:r}})}}function u(){let[e,t]=a.useState(d);return a.useEffect(()=>(i.push(t),()=>{let e=i.indexOf(t);e>-1&&i.splice(e,1)}),[e]),{...e,toast:c,dismiss:e=>l({type:"DISMISS_TOAST",toastId:e})}}},50090:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>g});var a=r(95155),s=r(12115),n=r(14585),o=r(19708),i=r(13328),d=r(89106),l=r(86948),c=r(87270),u=r(11647),m=r(92033),f=r(15894),p=r(64269),x=r(55172);let b=e=>{switch(e){case"completed":return"Completato";case"pending":return"In attesa";case"failed":return"Fallito";default:return e}},h=e=>{switch(e){case"online":return"Online";case"in_person":return"In Sede";case"bank_transfer":return"Bonifico";case"bonus":return"Premio";default:return e}};function g(){let e=async()=>{let e=new x.Ay({orientation:"landscape"});e.internal.pageSize.getWidth();let t=20,a=async e=>{let t=await fetch(e),r=await t.blob();return new Promise(e=>{let t=new FileReader;t.onloadend=()=>e(t.result),t.readAsDataURL(r)})},s=await a("https://firebasestorage.googleapis.com/v0/b/libera-energia-soci.firebasestorage.app/o/grafimg%2Flogo.png?alt=media&token=2ae6fdd4-f165-4603-b170-d832d97bd004");e.addImage(s,"PNG",10,10,30,30),e.setFontSize(18),e.text("Libera Energia Arti Marziali",45,25),t=45,e.setFontSize(14),e.text("Storico Pagamenti",10,t),t+=10,e.setFontSize(11),e.setFont(void 0,"bold"),e.text("Data",10,t),e.text("Descrizione",45,t),e.text("Metodo",110,t),e.text("Importo",140,t,{align:"right"}),e.text("Stato",170,t),e.setFont(void 0,"normal"),t+=7,r.forEach(r=>{t>190&&(e.addPage(),t=20),e.text(r.createdAt?(0,d.GP)(r.createdAt.toDate(),"dd/MM/yyyy HH:mm"):"N/D",10,t),e.text(r.description||("bonus"===r.paymentMethod?"Pagamento coperto da premio":""),45,t),e.text(h(r.paymentMethod),110,t),e.text(r.amount.toFixed(2)+" €",140,t,{align:"right"}),e.text(b(r.status),170,t),t+=7}),e.save("pagamenti.pdf")},[t]=(0,i.hD)(n.j2),[r,g]=(0,s.useState)([]),[y,j]=(0,s.useState)(!0),{toast:N}=(0,f.dj)();return(0,s.useEffect)(()=>{(async()=>{if(!t)return j(!1);try{let e=(0,o.collection)(n.db,"users",t.uid,"payments"),r=(0,o.query)(e,(0,o.orderBy)("createdAt","desc")),a=(await (0,o.getDocs)(r)).docs.map(e=>({id:e.id,...e.data()}));g(a)}catch(e){console.error("Error fetching payments:",e),N({variant:"destructive",title:"Errore",description:"Impossibile caricare lo storico dei pagamenti."})}finally{j(!1)}})()},[t,N]),(0,a.jsxs)(l.Zp,{className:"max-w-3xl mx-auto",children:[(0,a.jsx)(l.aR,{children:(0,a.jsxs)("div",{className:"flex justify-between items-start",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(l.ZB,{children:"I Miei Pagamenti"}),(0,a.jsx)(l.BT,{children:"Qui trovi lo storico di tutte le tue transazioni e il loro stato."})]}),(0,a.jsx)("button",{onClick:e,className:"px-3 py-2 bg-green-600 text-white font-bold rounded shadow hover:bg-green-700 transition w-fit",children:"Salva PDF"})]})}),(0,a.jsx)(l.Wu,{children:y?(0,a.jsx)("div",{className:"flex justify-center items-center h-48",children:(0,a.jsx)(m.A,{className:"h-8 w-8 animate-spin"})}):(0,a.jsx)("div",{className:"overflow-x-auto w-full",children:(0,a.jsxs)(c.XI,{className:"min-w-[500px] md:min-w-0",id:"payments-table",children:[(0,a.jsx)(c.A0,{children:(0,a.jsxs)(c.Hj,{children:[(0,a.jsx)(c.nd,{className:"min-w-[90px] font-bold",children:"Data"}),(0,a.jsx)(c.nd,{className:"min-w-[120px] font-bold",children:"Descrizione"}),(0,a.jsx)(c.nd,{className:"min-w-[80px] font-bold",children:"Metodo"}),(0,a.jsx)(c.nd,{className:"text-right min-w-[70px] font-bold",children:"Importo"}),(0,a.jsx)(c.nd,{className:"text-center min-w-[80px] font-bold",children:"Stato"})]})}),(0,a.jsx)(c.BF,{children:r.length>0?r.map(e=>(0,a.jsxs)(c.Hj,{children:[(0,a.jsx)(c.nA,{className:"font-medium",children:e.createdAt?(0,d.GP)(e.createdAt.toDate(),"dd/MM/yyyy HH:mm"):"N/D"}),(0,a.jsx)(c.nA,{children:e.description||("bonus"===e.paymentMethod?"Pagamento coperto da premio":"")}),(0,a.jsx)(c.nA,{children:h(e.paymentMethod)}),(0,a.jsxs)(c.nA,{className:"text-right",children:[e.amount.toFixed(2)," €"]}),(0,a.jsx)(c.nA,{className:"text-center",children:(0,a.jsx)(u.E,{variant:(e=>{switch(e){case"completed":return"default";case"pending":default:return"secondary";case"failed":return"destructive"}})(e.status),className:(0,p.cn)({"bg-success text-success-foreground hover:bg-success/80":"completed"===e.status}),children:b(e.status)})})]},e.id)):(0,a.jsx)(c.Hj,{children:(0,a.jsx)(c.nA,{colSpan:5,className:"text-center h-24",children:"Nessun pagamento trovato."})})})]})})})]})}},51778:(e,t,r)=>{Promise.resolve().then(r.bind(r,50090))},64269:(e,t,r)=>{"use strict";r.d(t,{cn:()=>n});var a=r(2821),s=r(75889);function n(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return(0,s.QP)((0,a.$)(t))}},86948:(e,t,r)=>{"use strict";r.d(t,{BT:()=>l,Wu:()=>c,ZB:()=>d,Zp:()=>o,aR:()=>i,wL:()=>u});var a=r(95155),s=r(12115),n=r(64269);let o=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)("div",{ref:t,className:(0,n.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",r),...s})});o.displayName="Card";let i=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)("div",{ref:t,className:(0,n.cn)("flex flex-col space-y-1.5 p-6",r),...s})});i.displayName="CardHeader";let d=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)("h3",{ref:t,className:(0,n.cn)("text-2xl font-semibold leading-none tracking-tight",r),...s})});d.displayName="CardTitle";let l=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)("div",{ref:t,className:(0,n.cn)("text-sm text-muted-foreground",r),...s})});l.displayName="CardDescription";let c=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)("div",{ref:t,className:(0,n.cn)("p-6 pt-0",r),...s})});c.displayName="CardContent";let u=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)("div",{ref:t,className:(0,n.cn)("flex items-center p-6 pt-0",r),...s})});u.displayName="CardFooter"},87270:(e,t,r)=>{"use strict";r.d(t,{A0:()=>i,BF:()=>d,Hj:()=>l,XI:()=>o,nA:()=>u,nd:()=>c});var a=r(95155),s=r(12115),n=r(64269);let o=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)("div",{className:"relative w-full overflow-auto",children:(0,a.jsx)("table",{ref:t,className:(0,n.cn)("w-full caption-bottom text-sm",r),...s})})});o.displayName="Table";let i=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)("thead",{ref:t,className:(0,n.cn)("[&_tr]:border-b",r),...s})});i.displayName="TableHeader";let d=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)("tbody",{ref:t,className:(0,n.cn)("[&_tr:last-child]:border-0",r),...s})});d.displayName="TableBody",s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)("tfoot",{ref:t,className:(0,n.cn)("border-t bg-muted/50 font-medium [&>tr]:last:border-b-0",r),...s})}).displayName="TableFooter";let l=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)("tr",{ref:t,className:(0,n.cn)("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",r),...s})});l.displayName="TableRow";let c=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)("th",{ref:t,className:(0,n.cn)("h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0",r),...s})});c.displayName="TableHead";let u=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)("td",{ref:t,className:(0,n.cn)("p-4 align-middle [&:has([role=checkbox])]:pr-0",r),...s})});u.displayName="TableCell",s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)("caption",{ref:t,className:(0,n.cn)("mt-4 text-sm text-muted-foreground",r),...s})}).displayName="TableCaption"}},e=>{e.O(0,[2992,7138,5033,3930,4909,3947,7134,3328,9106,6241,8441,1255,7358],()=>e(e.s=51778)),_N_E=e.O()}]);